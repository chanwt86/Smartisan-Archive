<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Smartisan Icon Archive</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg:#181a1e;
      --tile:#22252b;
      --tile-size: 160px;
      --img-percent: 50%;
      --gap: 0px;
      --ratio-w:2.35;
      --ratio-h:3;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:var(--bg);
      font-family:system-ui,-apple-system,Segoe UI,Inter,sans-serif;
      color:#eaeaea}
    header{
      padding:20px;text-align:center}
    .topbar{
      height:84px;
      background:#101214;
      display:flex;
      align-items:center;
      gap:12px;
      padding:0 50px;
      border-bottom:1px solid var(--gridline);
    }
    .logo{
      width:32px;
      height:32px;
      display:block;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      text-decoration:none;
      color:inherit;
    }
    .brand svg{
      width:32px;
      height:32px;
    }
    .brand .title{
      font-size:18px;
      font-weight:600;
      letter-spacing:.2px;
    }
    .grid{
      display:grid;
      grid-template-columns: repeat(6, var(--tile-size));
      gap: var(--gap);
      padding: 1px;
      margin: 40px auto;
      justify-content:center;
    }
    .grid .tile:nth-child(1)  { background:#3c3e43; }
    .grid .tile:nth-child(2)  { background:#43454a; }
    .grid .tile:nth-child(3)  { background:#43454a; }
    .grid .tile:nth-child(4)  { background:#33353a; }
    .grid .tile:nth-child(5)  { background:#34363c; }
    .grid .tile:nth-child(6)  { background:#303136; }

    .grid .tile:nth-child(7)  { background:#3a3c41; }
    .grid .tile:nth-child(8)  { background:#35383b; }
    .grid .tile:nth-child(9)  { background:#3f4146; }
    .grid .tile:nth-child(10) { background:#3a3c41; }
    .grid .tile:nth-child(11) { background:#35383b; }
    .grid .tile:nth-child(12) { background:#3f4146; }

    .grid .tile:nth-child(13) { background:#33353a; }
    .grid .tile:nth-child(14) { background:#34363c; }
    .grid .tile:nth-child(15) { background:#303136; }
    .grid .tile:nth-child(16) { background:#3c3e43; }
    .grid .tile:nth-child(17) { background:#43454a; }
    .grid .tile:nth-child(18) { background:#43454a; }

    .tile{
      width: var(--tile-w);
      aspect-ratio: var(--ratio-w) / var(--ratio-h);
      border: 1px solid var(--gridline);
      border-left:0;
      border-top:0;
      border-radius: 2px;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.06),
        inset 0 -1px 2px rgba(0,0,0,.45);
      border: 1px solid var(--gridline);
    }
    .tile img{
      max-width: var(--img-percent) !important;
      max-height: var(--img-percent) !important;
      width: auto !important;
      height: auto !important;
      object-fit: contain;
      image-rendering: auto;
      filter: drop-shadow(0px -2px 5px rgba(0,0,0,0.69));
    }
    .tile.is-empty:hover{ box-shadow:
      inset 0 1px 1px rgba(255,255,255,.08),
      inset 0 -1px 2px rgba(0,0,0,.40);
      cursor: default;
    }

    .wrap{
      overflow-x:auto; 
      padding: 0 12px;}
    .stage{
      margin: 0 auto;}
    footer{
      color:#8a8a8a;
      font-size:12px;
      text-align:center;padding:24px}

    .pager{
        display:flex; align-items:center; justify-content:center; gap:10px;
      margin:12px auto 24px;
    }
    .pager .dot{
      --dot-size:10px;
      width:var(--dot-size); height:var(--dot-size);
      border-radius:9999px;
      border:1px solid #3a3f46;
      background:#1a1d22;
      opacity:.55; padding:0; cursor:pointer;
    }
    .pager .dot:hover{ opacity:.9; }
    .pager .dot.active{
      background:#eaeaea; border-color:#eaeaea; opacity:1;
      box-shadow:0 0 0 3px rgba(234,234,234,.12);
    }
    .pager .jump{
      height:22px; padding:0 8px;
      border:1px solid #3a3f46; background:#1a1d22; color:#eaeaea;
      border-radius:6px; font-size:12px; cursor:pointer; opacity:.85;
    }
    .pager .jump:hover{ opacity:1; }
    .pager .jump:disabled{ opacity:.35; cursor:default; }
  </style>
</head>
  
<body>
  <header class="topbar">
    <a class="brand" href="/">
      <img class="logo" src="smartisan_logo.png" alt="Smartisan Logo">
      <span class="title">Smartisan Icon Archive</span>
    </a>
  </header>

  <div class="wrap">
    <main class="stage">
      <section class="grid">
      </section>
      <nav class="pager" aria-label="Pagination">
      </nav>
    </main>
  </div>

  <footer>
    Smartisan is a registered trademark of Smartisan Technology Co., Ltd. · Non-commercial archival project.
  </footer>

  <script>
  const PAGE_SIZE = 18;
  const GRID_SELECTOR = '.grid';

  function shuffle(a){
    const arr = a.slice();
    for (let i = arr.length - 1; i > 0; i--){
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  let ICONS = [];   // [{path, category}, …]

  function renderPager(page, totalPages){
    const pager = document.querySelector('.pager');
    if (!pager) return;

    // Hide when only 1 page
    pager.style.display = totalPages > 1 ? 'flex' : 'none';
    pager.innerHTML = '';

    const BLOCK = 10;
    const blockStart = Math.floor((page - 1) / BLOCK) * BLOCK + 1;      // 1, 11, 21, ...
    const blockEnd   = Math.min(blockStart + BLOCK - 1, totalPages);    // 10, 20, ...

    // prev 10
    const prevBlock = blockStart - BLOCK;
    const btnPrev10 = document.createElement('button');
    btnPrev10.type = 'button';
    btnPrev10.className = 'jump';
    btnPrev10.textContent = 'Prev 10 Pages';
    btnPrev10.disabled = (prevBlock < 1);
    if (!btnPrev10.disabled) btnPrev10.onclick = () => renderPage(prevBlock);
    pager.appendChild(btnPrev10);

    // mid 10
    for (let i = blockStart; i <= blockEnd; i++){
      const dot = document.createElement('button');
      dot.type = 'button';
      dot.className = 'dot' + (i === page ? ' active' : '');
      dot.setAttribute('aria-label', `Go to page ${i}`);
      if (i === page) dot.setAttribute('aria-current', 'page');
      dot.onclick = () => renderPage(i);
      pager.appendChild(dot);
    }

    // next 10
    const nextBlock = blockEnd + 1;
    const btnNext10 = document.createElement('button');
    btnNext10.type = 'button';
    btnNext10.className = 'jump';
    btnNext10.textContent = 'Next 10 Pages';
    btnNext10.disabled = (nextBlock > totalPages);
    if (!btnNext10.disabled) btnNext10.onclick = () => renderPage(nextBlock);
    pager.appendChild(btnNext10);
  }

  function renderPage(page=1){
    const grid = document.querySelector(GRID_SELECTOR);
    if (!grid || !ICONS.length) return;

    // Every refresh = reshuffle
    const order = shuffle(ICONS);
    const total = order.length;
    const totalPages = Math.max(1, Math.ceil(total / PAGE_SIZE));
    page = Math.min(Math.max(1, page), totalPages);
    const start = (page-1) * PAGE_SIZE;

    const tiles = [];
    for (let i=0;i<PAGE_SIZE;i++){
      const item = order[start + i];
      if (item) tiles.push(`<div class="tile"><img src="${item.path}" alt="" loading="lazy"></div>`);
      else tiles.push(`<div class="tile is-empty" aria-hidden="true"></div>`);
    }
    grid.innerHTML = tiles.join('');

    renderPager(page, totalPages);
    const url = new URL(location);
    url.searchParams.set('page', String(page));
    history.replaceState(null, '', url);
  }

  async function init(){
    const res = await fetch('data/icons.json', { cache: 'no-cache' });
    ICONS = await res.json();             
    const p = parseInt(new URL(location).searchParams.get('page') || '1', 10);
    renderPage(isNaN(p) ? 1 : p);

    window.addEventListener('popstate', () => {
      const p2 = parseInt(new URL(location).searchParams.get('page') || '1', 10);
      renderPage(isNaN(p2) ? 1 : p2);
    });
  }
  init();
  </script>
</body>
</html>